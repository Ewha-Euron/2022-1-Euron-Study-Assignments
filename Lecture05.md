# CS231n Lecture 5 | Convolutional Neural Networks

## 1. Neural Networksì˜ ì—­ì‚¬

### 1) Hubel & Wieselì˜ ì—°êµ¬

- ìì„¸í•œ ì—°êµ¬ ë‚´ìš©ì€ 1ê°•ì„ ì°¸ê³ 

![Untitled (5)](https://user-images.githubusercontent.com/79077316/161549788-a63a19bd-c1b1-4899-bc2d-310300a72c5c.png)

**ì‹¤í—˜ì—ì„œ ì•Œê²Œ ëœ ê²ƒ**

1. ì‹¤í—˜ì—ì„œ ë‰´ëŸ°ì´ oriented edgesì™€ shapesì™€ ê°™ì€ ê²ƒì— ë°˜ì‘í•œë‹¤ëŠ” ê²ƒì„ ì•Œê²Œ ë¨
2. ì‹¤í—˜ ê²°ê³¼ ëŒ€ë‡Œ í”¼ì§ˆ ë‚´ë¶€ì— ì§€í˜•ì ì¸ ë§¤í•‘(topographical mapping)ì´ ì¡´ì¬í•˜ëŠ” ê²ƒì„ ì•Œê²Œ ë¨
3. í”¼ì§ˆ ë‚´ ì„œë¡œ ì¸ì ‘í•´ ìˆëŠ” ì„¸í¬ë“¤ì€ visual field ë‚´ì— ì§€ì—­ì„±ì„ ë„ê³  ìˆìŒ
4. ë‰´ëŸ°ë“¤ì´ ê³„ì¸µì ì¸ êµ¬ì¡°ë¥¼ ì§€ë‹˜
    - simple cell, complex cell, hypercomplex cell ëª¨ë‘ ê³„ì¸µì ìœ¼ë¡œ ì—°ê²°ë˜ì–´ ìˆìŒ
    - simple cell
        - ë‹¤ì–‘í•œ edgesì˜ ë°©í–¥ê³¼ ë¹›ì˜ ë°©í–¥ì— ë°˜ì‘
    - complex cell
        - ë¹›ì˜ ë°©í–¥ ë¿ë§Œ ì•„ë‹ˆë¼ ì›€ì§ì„ì—ì„œ ë°˜ì‘
    - hypercomplex cell
        - ë ì (end point) ê³¼ ê°™ì€ê²ƒì— ë°˜ì‘
    
    ğŸ‘‰ğŸ» ë¬¼ì²´ì˜ corner ë˜ëŠ” blobì— ëŒ€í•œ ì•„ì´ë””ì–´ë¥¼ ì–»ê²Œ ë¨
    

### 2) Neocognitron (Fukushima, 1980)

![Untitled (6)](https://user-images.githubusercontent.com/79077316/161549800-b32e5ceb-4d82-4d59-9d3c-55bc69b15340.png)

- hubelê³¼ wieselì˜ ì—°êµ¬ì—ì„œ ë°œê²¬í•œ simple cellê³¼ complex cellì˜ ì•„ì´ë””ì–´ë¥¼ ì‚¬ìš©í•œ ìµœì´ˆì˜ NN
- simple cellê³¼ complex cellì„ êµì°¨ì‹œí‚´ (SCSC...)
- Simple cellsì€ í•™ìŠµê°€ëŠ¥í•œ parametersë¥¼ ê°€ì§€ê³  ìˆê³ , Complex cellsì€ poolingê³¼ ê°™ì€ ê²ƒìœ¼ë¡œ êµ¬í˜„í•˜ì—¬ ì‘ì€ ë³€í™”ì— Simple cellsë³´ë‹¤ ë” ê°•ì¸í•¨

### 3) LeNet, 1998

![Untitled (7)](https://user-images.githubusercontent.com/79077316/161549814-41d61b7a-4ed1-4a16-bce9-a4b3c97c3f14.png)

- ìµœì´ˆë¡œ NNì„ í•™ìŠµì‹œí‚¤ê¸° ìœ„í•´ Backpropê³¼ gradient-based learningì„ ì ìš©í•¨
- ë¬¸ì„œ ì¸ì‹ì—ì„œ ê½¤ ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì„ (ìš°í¸ë²ˆí˜¸ì˜ ìˆ«ì ì¸ì‹)

### 4) AlexNet, 2012

![Untitled (8)](https://user-images.githubusercontent.com/79077316/161549880-5342c913-18eb-4575-aa80-ad1cb5a6e0d9.png)

- convnetìœ¼ë¡œ ì´ì „ì˜ NNë³´ë‹¤ ë” í¬ê³  ê¹Šì–´ì§
- GPUì˜ ë°œì „ìœ¼ë¡œ ImageNet datasetê³¼ ê°™ì€ ëŒ€ê·œëª¨ì˜ ë°ì´í„°ë„ í™œìš©í•  ìˆ˜ ìˆê²Œ ë¨

## 2. Convolutional Neural Networks

### 1) Conv layerì˜ ì—°ì‚° ê³¼ì •

![Untitled (9)](https://user-images.githubusercontent.com/79077316/161549867-bb737fd0-e3df-46bf-9290-3af19f251d5c.png)

- FC layerì™€ Conv layerì˜ ì°¨ì´ì ì€ ê¸°ì¡´ì˜ êµ¬ì¡°ë¥¼ ë³´ì¡´ì‹œí‚¨ë‹¤ëŠ” ê²ƒì„
    - FC layerëŠ” ì…ë ¥ ì´ë¯¸ì§€ë¥¼ ë²¡í„° í•œ ì¤„ë¡œ ê¸¸ê²Œ íˆë‹¤ë©´ conv layerëŠ” ê¸°ì¡´ì˜ ì´ë¯¸ì§€ë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€í•¨
- ê°€ì¤‘ì¹˜ ê°’ì´ ë“¤ì–´ìˆëŠ” filterë¥¼ ì´ìš©í•´ì„œ ì´ë¯¸ì§€ë¥¼ ìŠ¬ë¼ì´ë”©í•˜ë©´ì„œ ë‚´ì  ì—°ì‚°ì„ ìˆ˜í–‰í•¨
- filterëŠ” ì…ë ¥ì˜ ê¹Šì´(depth)ë§Œí¼ í™•ì¥ë¨
- 5x5x3ì˜ í•„í„°ëŠ” ë²¡í„°ë¥¼ ê¸¸ê²Œ í´ì„œ 1x75 ê¸¸ì´ì˜ ë²¡í„°ê°€ ë¨
- í•„í„°ì˜ ê° wì™€ ì´ì— í•´ë‹¹í•˜ëŠ” ì´ë¯¸ì§€ì˜ í”½ì…€ ê°’ì„ ê³±í•¨
    - W^Tx + b
    - Wë¥¼ transposeí•œ ê°’ê³¼ ì…ë ¥ ì´ë¯¸ì§€ì˜ í”½ì…€ ê°’ì„ ë‚´ì  ì—°ì‚°í•˜ê³  bias ê°’ì„ ë”í•¨

### 2) Convolution ì—°ì‚°

![Untitled (10)](https://user-images.githubusercontent.com/79077316/161549892-a45bc997-3595-45b1-a94a-a29ff00af0a2.png)

- convolution ì—°ì‚°ì€ ì…ë ¥ ì´ë¯¸ì§€ì˜ ì¢Œìƒë‹¨ë¶€í„° ì‹œì‘í•˜ì—¬ í•„í„°ì˜ ëª¨ë“  ìš”ì†Œë¥¼ ê°€ì§€ê³  ë‚´ì ì„ ìˆ˜í–‰í•˜ì—¬ í•˜ë‚˜ì˜ ê°’ì„ ì–»ê²Œ ë¨
- í•˜ë‚˜ì˜ í•„í„°ë¥¼ ê°€ì§€ê³  ì´ë¯¸ì§€ ì „ì²´ì— ëŒ€í•´ convolution ì—°ì‚°ì„ ìˆ˜í–‰í•´ì„œ ì¶œë ¥ ê²°ê³¼ activation mapì„ ì–»ìŒ

![Untitled (11)](https://user-images.githubusercontent.com/79077316/161549914-0b98d25a-a52a-4ee8-b26e-dbb3105099cd.png)

- ë³´í†µ ìœ„ ê·¸ë¦¼ê³¼ ê°™ì´ convolution layerì—ì„œëŠ” í•„í„°ë§ˆë‹¤ ë‹¤ë¥¸ íŠ¹ì§•ì„ ì¶”ì¶œí•´ë‚´ê¸° ìœ„í•´ ì—¬ëŸ¬ ê°œì˜ í•„í„°ë¥¼ ì‚¬ìš©í•¨

![Untitled (12)](https://user-images.githubusercontent.com/79077316/161549825-887ddbb6-5821-4c51-b021-56c34f79e22a.png)

- conv layerë“¤ì„ ì—°ì‚°í•˜ê³  ê°ê°ì„ ìŒ“ì•„ ì˜¬ë¦¬ê²Œ ë˜ë©´ ìœ„ì™€ ê°™ì´ ê°„ë‹¨í•œ linear layerë“¤ì´ ì—¬ëŸ¬ ê²¹ ìŒ“ì¸ neural networkê°€ ë¨

![Untitled (13)](https://user-images.githubusercontent.com/79077316/161549924-be90d83c-7aab-421a-9f5b-5557f297df6d.png)

- conv layer ì‚¬ì´ì‚¬ì´ì— activation functionì´ë‚˜ pooling layerì„ ì¶”ê°€í•¨
- ê° layerì˜ ì¶œë ¥ì€ ê·¸ ë‹¤ìŒ layerì˜ ì…ë ¥ì´ ë¨
- ê° layerëŠ” ì—¬ëŸ¬ ê°œì˜ í•„í„°ë¥¼ ê°€ì§€ê³  ìˆê³ , ê° í•„í„°ë§ˆë‹¤ ê°ê°ì˜ activation mapì„ ë§Œë“¦

![Untitled (14)](https://user-images.githubusercontent.com/79077316/161549933-13b9f67d-578c-4fc0-9333-994eec8f555e.png)

- hubel & wieselì˜ ì—°êµ¬ ê²°ê³¼ì²˜ëŸ¼ ì—¬ëŸ¬ ê°œì˜ layerë“¤ì€ ê° í•„í„°ë¥¼ ê±°ì¹˜ë©´ì„œ ê³„ì¸µì ìœ¼ë¡œ í•™ìŠµí•¨
- ì•ìª½ì— ìˆëŠ” í•„í„°ì—ì„œëŠ” edgeì™€ ê°™ì€ low-level featureë¥¼ í•™ìŠµí•¨
- mid-levelì—ì„œëŠ” cornerë‚˜ blobsì™€ ê°™ì€ ì¢€ ë” ë³µì¡í•œ íŠ¹ì§•ì„ í•™ìŠµí•¨
- high-levelì—ì„œëŠ” ì¢€ ë” ê°ì²´ì™€ ë‹®ì€ ê²ƒë“¤ì´ ì¶œë ¥ ê²°ê³¼ë¡œ ë‚˜ì˜´
- layerì˜ ê³„ì¸µì— ë”°ë¼ ë‹¨ìˆœ/ë³µì¡í•œ íŠ¹ì§•ì´ ì¡´ì¬í•¨

![Untitled (15)](https://user-images.githubusercontent.com/79077316/161549944-09ff394d-8003-43dd-abc3-1e16569e6704.png)

- ê° activationì€ ì´ë¯¸ì§€ê°€ í•„í„°ë¥¼ í†µê³¼í•œ ê²°ê³¼ì´ê³ , ì´ë¯¸ì§€ ì¤‘ ì–´ëŠ ìœ„ì¹˜ì—ì„œ í•´ë‹¹ í•„í„°ê°€ í¬ê²Œ ë°˜ì‘í•˜ëŠ”ì§€ ì•Œë ¤ì¤Œ

### 3) Activation mapì˜ ì—°ì‚° ê³¼ì •

![Untitled (16)](https://user-images.githubusercontent.com/79077316/161549955-4c02d48b-5ad8-4d3e-9beb-fcdcf20bdeb8.png)

- ê°„ë‹¨í•œ ì˜ˆì‹œë¡œ 7 x 7 ì…ë ¥ì— 3 x 3 í•„í„°ê°€ ìˆë‹¤ê³  í•´ë³´ì
- 3x3 í•„í„°ë¥¼ ì´ë¯¸ì§€ì˜ ì™¼ìª½ ìƒë‹¨ë¶€í„° ì”Œì›Œì„œ í•´ë‹¹ ê°’ë“¤ì˜ ë‚´ì ì„ ìˆ˜í–‰í•¨
- ìœ„ ì´ë¯¸ì§€ì˜ ì—°ì‚° ê²°ê³¼ëŠ” activation mapì˜ ê°€ì¥ ì™¼ìª½, ìœ—ë¶€ë¶„ì˜ ì¶œë ¥ê°’ì´ ë¨
- ì—°ì‚°ì´ ëë‚˜ë©´, í•„í„°ë¥¼ ì˜¤ë¥¸ìª½ìœ¼ë¡œ í•œì¹¸ì”© ì›€ì§ì—¬ì„œ ë°˜ë³µ ì—°ì‚°ì„ ìˆ˜í–‰í•¨
- ì´ë ‡ê²Œ ë°˜ë³µí•˜ë©´ ê²°êµ­ 5x5ì˜ ì¶œë ¥ì„ ì–»ê²Œ ë¨

![Untitled (17)](https://user-images.githubusercontent.com/79077316/161549971-477cf5cc-c88c-4e02-bbed-a7366c8a9650.png)

- í•„í„°ë¥¼ ì´ë™í•˜ëŠ” ì¹¸ ìˆ˜ë¥¼ strideë¼ê³  í•¨
- stride=2ì¸ ê²½ìš° ì¶œë ¥ì€ 3x3ì´ ë¨
- stride=3ì¸ ê²½ìš° ì´ë¯¸ì§€ì˜ ì‚¬ì´ì¦ˆì— ë§ì•„ ë–¨ì–´ì§€ì§€ ì•Šì•„ ì œëŒ€ë¡œ ì—°ì‚°ì´ ë™ì‘í•˜ì§€ ì•ŠìŒ

![Untitled (18)](https://user-images.githubusercontent.com/79077316/161549980-a9b3c778-6325-48d4-aeea-6c25b2d5cffd.png)

- ìŠ¤íŠ¸ë¼ì´ë“œì˜ í¬ê¸°ì— ë”°ë¼ ì¶œë ¥ ì‚¬ì´ì¦ˆê°€ ì–´ë–»ê²Œ ë  ê²ƒì¸ì§€ ì•Œë ¤ì£¼ëŠ” ìˆ˜ì‹
- ìœ„ ìˆ˜ì‹ì„ ì´ìš©í•´ì„œ ì–´ë–¤ í¬ê¸°ì˜ í•„í„°ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ì§€, strideë¥¼ ëª‡ìœ¼ë¡œ í–ˆì„ ë•Œ ì´ë¯¸ì§€ì— ê¼­ ë§ëŠ”ì§€, ì¶œë ¥ì˜ ì‚¬ì´ì¦ˆëŠ” ì–´ë–»ê²Œ ë˜ëŠ”ì§€ ì•Œ ìˆ˜ ìˆìŒ
- strideê°€ í´ìˆ˜ë¡ ì¶œë ¥ì€ ì ì  ì‘ì•„ì§

**zero-padding**

- ì¶œë ¥ì˜ ì‚¬ì´ì¦ˆë¥¼ ì¡°ì ˆí•˜ëŠ” ë°©ë²• â†’ ì…ë ¥ ì‚¬ì´ì¦ˆì™€ ì¶œë ¥ ì‚¬ì´ì¦ˆë¥¼ ê°™ë„ë¡ í•˜ê¸° ìœ„í•¨
- ë°”ê¹¥ìª½ ë¶€ë¶„ì˜ ì´ë¯¸ì§€ í”½ì…€ê°’ì´ ìƒëŒ€ì ìœ¼ë¡œ ëœ ê°•ì¡°ë˜ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ë°©ë²•
- ì´ë¯¸ì§€ì˜ ê°€ì¥ ìë¦¬ì— 0ì„ ì±„ì›Œ ë„£ëŠ” ë°©ë²•

![Untitled (19)](https://user-images.githubusercontent.com/79077316/161549991-3ff7db5d-b494-442a-82b5-4472e4ed2246.png)

- zero-paddingì„ ì ìš©í•˜ë©´0 N=9ë¥¼ ë„£ì–´ ìˆ˜ì‹ì„ ì‚¬ìš©í•˜ë©´ ë¨
- ìœ„ ì˜ˆì œì˜ ê²½ìš° ì¶œë ¥ì˜ ì‚¬ì´ì¦ˆëŠ” 7x7x(í•„í„°ì˜ ê°œìˆ˜)

### 4) Brain Neuron ê´€ì ì—ì„œì˜ Conv layer

![Untitled (20)](https://user-images.githubusercontent.com/79077316/161549998-c2f8c581-a54e-4eed-9662-eb8d73fa4dfa.png)

- ì „ì²´ ì´ë¯¸ì§€ì˜ íŠ¹ì • ìœ„ì¹˜ì— í•„í„°ë¥¼ ë†“ê³  ë‚´ì ì„ ìˆ˜í–‰
- ë‡Œì˜ ë‰´ëŸ°ê³¼ ë‹¤ë¥¸ ì ì€ ìš°ë¦¬ ë‡Œì˜ ë‰´ëŸ°ì€ local connectivityë¥¼ ê°€ì§€ê³  ìˆìŒ
    - conv layerì²˜ëŸ¼ ìŠ¬ë¼ì´ë”©ì„ í•´ì„œ ëª¨ë“  ë¶€ë¶„ê³¼ ì—°ì‚°ì„ í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼, ìš°ë¦¬ ë‡Œì˜ ë‰´ëŸ°ì€ íŠ¹ì • ë¶€ë¶„ì—ë§Œ ì—°ê²°ë˜ì–´ ìˆìŒ
    - í•˜ë‚˜ì˜ ë‰´ëŸ°ì€ í•œ ë¶€ë¶„ë§Œ ì²˜ë¦¬í•˜ê³ , ë‰´ëŸ°ë“¤ì´ ì—¬ëŸ¬ ê°œê°€ ëª¨ì—¬ì„œ ì „ì²´ ì´ë¯¸ì§€ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„
- ìœ„ ì´ë¯¸ì§€ì—ì„œ í•œ ë‰´ëŸ°ì˜ receptive fieldëŠ” 5x5ì„
    - receptive fieldë€ í•œ ë‰´ëŸ°ì´ í•œ ë²ˆì— ìˆ˜ìš©í•  ìˆ˜ ìˆëŠ” ì˜ì—­ì„ ì˜ë¯¸

![Untitled (21)](https://user-images.githubusercontent.com/79077316/161550009-9e8b6094-47dd-4553-839c-c7be4aec2775.png)

- ì¶œë ¥ì˜ ì‚¬ì´ì¦ˆëŠ” 28x28x(í•„í„°ì˜ ê°œìˆ˜)
- íŒŒë€ìƒ‰ volume ì•ˆì— 5ê°œì˜ ì ì€ ì •í™•í•˜ê²Œ ê°™ì€ ì§€ì—­ì—ì„œ ì¶”ì¶œëœ ì„œë¡œ ë‹¤ë¥¸ íŠ¹ì§•ì„

### 5) Pooling layer

![Untitled (22)](https://user-images.githubusercontent.com/79077316/161550021-223ac637-845e-4cb5-a0a8-bc6cc4e059ef.png)

- CNNì—ëŠ” conv layer ë§ê³ ë„ pooling layerê°€ ìˆìŒ
- pooling layerëŠ” representationì„ ë” ì‘ê²Œ ë§Œë“¦
    - representationì„ ì‘ê²Œ í•˜ë©´ íŒŒë¼ë¯¸í„°ì˜ ìˆ˜ê°€ ì¤„ê²Œ ë¨
    - ê³µê°„ì ì¸ ë¶ˆë³€ì„±ë„ ì–»ì„ ìˆ˜ ìˆìŒ
- ê²°êµ­ pooling layerê°€ í•˜ëŠ” ì¼ì€ downsampling
- ë‹¨, depthëŠ” ë³€í•˜ì§€ ì•ŠìŒ

![Untitled (23)](https://user-images.githubusercontent.com/79077316/161550027-b42a6ea8-571c-4f9e-83f9-d96b4af5ced0.png)

- ì¼ë°˜ì ìœ¼ë¡œ max poolingì´ ë§ì´ ì“°ì„
- 2x2 í•„í„°ì´ê³ , stride=2ì¼ ë•Œ í•„í„° ì•ˆì— ê°€ì¥ í° ê°’ì„ ê³ ë¥´ë©´ ë¨
- conv layer ì—°ì‚°ê³¼ ë‹¬ë¦¬ pooling í•  ë•ŒëŠ” ê²¹ì¹˜ì§€ ì•Šë„ë¡ í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì„